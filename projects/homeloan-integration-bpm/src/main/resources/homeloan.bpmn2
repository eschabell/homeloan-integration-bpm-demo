<?xml version="1.0" encoding="UTF-8"?> 
<definitions id="Definition"
             targetNamespace="http://www.omg.org/bpmn20"
             typeLanguage="http://www.java.com/javaTypes"
             expressionLanguage="http://www.mvel.org/2.0"
             xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd"
             xmlns:g="http://www.jboss.org/drools/flow/gpd"
             xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
             xmlns:tns="http://www.jboss.org/drools">

  <itemDefinition id="_isQualifiedItem" structureRef="Boolean" />
  <itemDefinition id="_firstNameItem" structureRef="String" />
  <itemDefinition id="_lastNameItem" structureRef="String" />
  <itemDefinition id="_dobItem" structureRef="String" />
  <itemDefinition id="_ssnItem" structureRef="String" />
  <itemDefinition id="_creditScoreItem" structureRef="String" />
  <itemDefinition id="_approvedItem" structureRef="Boolean" />
  <itemDefinition id="_approvedRateItem" structureRef="Float" />
  <itemDefinition id="_explanationItem" structureRef="String" />
  <itemDefinition id="_insuranceCostItem" structureRef="Float" />

  <process processType="Private" isExecutable="true" id="mortgages.homeloan" name="homeloan" tns:packageName="mortgages" tns:version="1" >

    <!-- process variables -->
    <property id="isQualified" itemSubjectRef="_isQualifiedItem"/>
    <property id="firstName" itemSubjectRef="_firstNameItem"/>
    <property id="lastName" itemSubjectRef="_lastNameItem"/>
    <property id="dob" itemSubjectRef="_dobItem"/>
    <property id="ssn" itemSubjectRef="_ssnItem"/>
    <property id="creditScore" itemSubjectRef="_creditScoreItem"/>
    <property id="approved" itemSubjectRef="_approvedItem"/>
    <property id="approvedRate" itemSubjectRef="_approvedRateItem"/>
    <property id="explanation" itemSubjectRef="_explanationItem"/>
    <property id="insuranceCost" itemSubjectRef="_insuranceCostItem"/>

    <!-- nodes -->
    <startEvent id="_ED0E70CA-BEE1-4A9E-8730-049534065193" name="" />
    <scriptTask id="_574F2B45-72F8-4077-8DD3-40CCAD7A3087" name="Read application" scriptFormat="http://www.java.com/java" >
      <script>System.out.println("Entering " + kcontext.getNodeInstance().getNodeName() +" Node");

System.out.println("Read application; fill in variables");
kcontext.setVariable("firstName", "John");
kcontext.setVariable("lastName", "Doe");
kcontext.setVariable("dob", "1970/1/1");
kcontext.setVariable("ssn", "123-456-789");

System.out.println("Leaving " + kcontext.getNodeInstance().getNodeName() +" Node");
</script>
    </scriptTask>
    <exclusiveGateway id="_62C9B6D6-7995-4CFD-87A1-B71F8F0EE9CE" name="Is pre-qualified?" gatewayDirection="Diverging" />
    <scriptTask id="_0140E64D-21C5-46C1-8D19-36969C0210EF" name="Communicate rejection" scriptFormat="http://www.java.com/java" >
      <script>System.out.println("Entering " + kcontext.getNodeInstance().getNodeName() +" Node");

System.out.println("Rejected!");

System.out.println("Leaving " + kcontext.getNodeInstance().getNodeName() +" Node");
</script>
    </scriptTask>
    <scriptTask id="_A98387E7-BA85-4F34-AD98-EBE72F43BC4C" name="Communicate approval" scriptFormat="http://www.java.com/java" >
      <script>System.out.println("Entering " + kcontext.getNodeInstance().getNodeName() +" Node");

System.out.println("Approved!");

System.out.println("Leaving " + kcontext.getNodeInstance().getNodeName() +" Node");
</script>
    </scriptTask>
    <exclusiveGateway id="_0CB62399-6EE4-4612-B91F-E914635B52FE" name="" gatewayDirection="Converging" />
    <endEvent id="_23DF43DD-8169-4ECE-9129-4BFE442A3730" name="" />
    <task id="_10" name="Credit Report Node" tns:taskName="CreditReportNode" >
      <ioSpecification>
        <dataInput id="_10_lastNameInput" name="lastName" />
        <dataInput id="_10_dobInput" name="dob" />
        <dataInput id="_10_ssnInput" name="ssn" />
        <dataInput id="_10_firstNameInput" name="firstName" />
        <dataOutput id="_10_creditScoreOutput" name="creditScore" />
        <inputSet>
          <dataInputRefs>_10_lastNameInput</dataInputRefs>
          <dataInputRefs>_10_dobInput</dataInputRefs>
          <dataInputRefs>_10_ssnInput</dataInputRefs>
          <dataInputRefs>_10_firstNameInput</dataInputRefs>
        </inputSet>
        <outputSet>
          <dataOutputRefs>_10_creditScoreOutput</dataOutputRefs>
        </outputSet>
      </ioSpecification>
      <dataInputAssociation>
        <sourceRef>lastName</sourceRef>
        <targetRef>_10_lastNameInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>dob</sourceRef>
        <targetRef>_10_dobInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>ssn</sourceRef>
        <targetRef>_10_ssnInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>firstName</sourceRef>
        <targetRef>_10_firstNameInput</targetRef>
      </dataInputAssociation>
      <dataOutputAssociation>
        <sourceRef>_10_creditScoreOutput</sourceRef>
        <targetRef>creditScore</targetRef>
      </dataOutputAssociation>
    </task>
    <task id="_11" name="Prequalification Node" tns:taskName="PrequalificationNode" >
      <extensionElements>
        <tns:onExit-script scriptFormat="http://www.java.com/java">
          <script>System.out.println("Leaving Prequalification Node; approved = " + approved);

kcontext.setVariable("isQualified", approved);</script>
        </tns:onExit-script>
      </extensionElements>
      <ioSpecification>
        <dataInput id="_11_creditScoreInput" name="creditScore" />
        <dataOutput id="_11_approvedOutput" name="approved" />
        <dataOutput id="_11_approvedRateOutput" name="approvedRate" />
        <dataOutput id="_11_explanationOutput" name="explanation" />
        <dataOutput id="_11_insuranceCostOutput" name="insuranceCost" />
        <inputSet>
          <dataInputRefs>_11_creditScoreInput</dataInputRefs>
        </inputSet>
        <outputSet>
          <dataOutputRefs>_11_approvedOutput</dataOutputRefs>
          <dataOutputRefs>_11_approvedRateOutput</dataOutputRefs>
          <dataOutputRefs>_11_explanationOutput</dataOutputRefs>
          <dataOutputRefs>_11_insuranceCostOutput</dataOutputRefs>
        </outputSet>
      </ioSpecification>
      <dataInputAssociation>
        <sourceRef>creditScore</sourceRef>
        <targetRef>_11_creditScoreInput</targetRef>
      </dataInputAssociation>
      <dataOutputAssociation>
        <sourceRef>_11_approvedOutput</sourceRef>
        <targetRef>approved</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>_11_approvedRateOutput</sourceRef>
        <targetRef>approvedRate</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>_11_explanationOutput</sourceRef>
        <targetRef>explanation</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>_11_insuranceCostOutput</sourceRef>
        <targetRef>insuranceCost</targetRef>
      </dataOutputAssociation>
    </task>

    <!-- connections -->
    <sequenceFlow id="_ED0E70CA-BEE1-4A9E-8730-049534065193-_574F2B45-72F8-4077-8DD3-40CCAD7A3087" sourceRef="_ED0E70CA-BEE1-4A9E-8730-049534065193" targetRef="_574F2B45-72F8-4077-8DD3-40CCAD7A3087" />
    <sequenceFlow id="_11-_62C9B6D6-7995-4CFD-87A1-B71F8F0EE9CE" sourceRef="_11" targetRef="_62C9B6D6-7995-4CFD-87A1-B71F8F0EE9CE" />
    <sequenceFlow id="_62C9B6D6-7995-4CFD-87A1-B71F8F0EE9CE-_0140E64D-21C5-46C1-8D19-36969C0210EF" sourceRef="_62C9B6D6-7995-4CFD-87A1-B71F8F0EE9CE" targetRef="_0140E64D-21C5-46C1-8D19-36969C0210EF" name="No" tns:priority="1" >
      <conditionExpression xsi:type="tFormalExpression" language="http://www.java.com/java" >System.out.println("Gateway: " + kcontext.getNodeInstance().getNodeName());

return isQualified == false;</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="_62C9B6D6-7995-4CFD-87A1-B71F8F0EE9CE-_A98387E7-BA85-4F34-AD98-EBE72F43BC4C" sourceRef="_62C9B6D6-7995-4CFD-87A1-B71F8F0EE9CE" targetRef="_A98387E7-BA85-4F34-AD98-EBE72F43BC4C" name="Yes" tns:priority="2" >
      <conditionExpression xsi:type="tFormalExpression" language="http://www.java.com/java" >System.out.println("Gateway: " + kcontext.getNodeInstance().getNodeName());

return isQualified == true;</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="_0140E64D-21C5-46C1-8D19-36969C0210EF-_0CB62399-6EE4-4612-B91F-E914635B52FE" sourceRef="_0140E64D-21C5-46C1-8D19-36969C0210EF" targetRef="_0CB62399-6EE4-4612-B91F-E914635B52FE" />
    <sequenceFlow id="_A98387E7-BA85-4F34-AD98-EBE72F43BC4C-_0CB62399-6EE4-4612-B91F-E914635B52FE" sourceRef="_A98387E7-BA85-4F34-AD98-EBE72F43BC4C" targetRef="_0CB62399-6EE4-4612-B91F-E914635B52FE" />
    <sequenceFlow id="_0CB62399-6EE4-4612-B91F-E914635B52FE-_23DF43DD-8169-4ECE-9129-4BFE442A3730" sourceRef="_0CB62399-6EE4-4612-B91F-E914635B52FE" targetRef="_23DF43DD-8169-4ECE-9129-4BFE442A3730" />
    <sequenceFlow id="_574F2B45-72F8-4077-8DD3-40CCAD7A3087-_10" sourceRef="_574F2B45-72F8-4077-8DD3-40CCAD7A3087" targetRef="_10" />
    <sequenceFlow id="_10-_11" sourceRef="_10" targetRef="_11" />

  </process>

  <bpmndi:BPMNDiagram>
    <bpmndi:BPMNPlane bpmnElement="mortgages.homeloan" >
      <bpmndi:BPMNShape bpmnElement="_ED0E70CA-BEE1-4A9E-8730-049534065193" >
        <dc:Bounds x="9" y="85" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_574F2B45-72F8-4077-8DD3-40CCAD7A3087" >
        <dc:Bounds x="76" y="68" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_62C9B6D6-7995-4CFD-87A1-B71F8F0EE9CE" >
        <dc:Bounds x="589" y="85" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_0140E64D-21C5-46C1-8D19-36969C0210EF" >
        <dc:Bounds x="669" y="16" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_A98387E7-BA85-4F34-AD98-EBE72F43BC4C" >
        <dc:Bounds x="669" y="149" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_0CB62399-6EE4-4612-B91F-E914635B52FE" >
        <dc:Bounds x="823" y="85" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_23DF43DD-8169-4ECE-9129-4BFE442A3730" >
        <dc:Bounds x="920" y="84" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_10" >
        <dc:Bounds x="200" y="71" width="166" height="73" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_11" >
        <dc:Bounds x="395" y="72" width="176" height="73" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="_ED0E70CA-BEE1-4A9E-8730-049534065193-_574F2B45-72F8-4077-8DD3-40CCAD7A3087" >
        <di:waypoint x="33" y="109" />
        <di:waypoint x="126" y="108" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_11-_62C9B6D6-7995-4CFD-87A1-B71F8F0EE9CE" >
        <di:waypoint x="483" y="108" />
        <di:waypoint x="613" y="109" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_62C9B6D6-7995-4CFD-87A1-B71F8F0EE9CE-_0140E64D-21C5-46C1-8D19-36969C0210EF" >
        <di:waypoint x="613" y="109" />
        <di:waypoint x="612" y="55" />
        <di:waypoint x="719" y="56" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_62C9B6D6-7995-4CFD-87A1-B71F8F0EE9CE-_A98387E7-BA85-4F34-AD98-EBE72F43BC4C" >
        <di:waypoint x="613" y="109" />
        <di:waypoint x="613" y="187" />
        <di:waypoint x="719" y="189" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_0140E64D-21C5-46C1-8D19-36969C0210EF-_0CB62399-6EE4-4612-B91F-E914635B52FE" >
        <di:waypoint x="719" y="56" />
        <di:waypoint x="848" y="57" />
        <di:waypoint x="847" y="109" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_A98387E7-BA85-4F34-AD98-EBE72F43BC4C-_0CB62399-6EE4-4612-B91F-E914635B52FE" >
        <di:waypoint x="719" y="189" />
        <di:waypoint x="847" y="190" />
        <di:waypoint x="847" y="109" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_0CB62399-6EE4-4612-B91F-E914635B52FE-_23DF43DD-8169-4ECE-9129-4BFE442A3730" >
        <di:waypoint x="847" y="109" />
        <di:waypoint x="944" y="108" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_574F2B45-72F8-4077-8DD3-40CCAD7A3087-_10" >
        <di:waypoint x="126" y="108" />
        <di:waypoint x="283" y="107" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_10-_11" >
        <di:waypoint x="283" y="107" />
        <di:waypoint x="483" y="108" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>

</definitions>